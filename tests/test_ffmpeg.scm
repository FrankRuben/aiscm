(use-modules (oop goops)
             (aiscm ffmpeg)
             (aiscm element)
             (aiscm image)
             (guile-tap))
(define video (open-input-video "fixtures/camera.avi"))
(define audio (open-input-video "fixtures/test.mp3"))
(define image (open-input-video "fixtures/fubk.png"))
(define frame (read-video video))
(ok (equal? '(320 240) (shape video))
    "Check frame size of input video")
(ok (throws? (open-input-video "fixtures/no-such-file.avi"))
    "Throw error if file does not exist")
(ok (throws? (shape audio))
    "Audio file does not have a frame size")
(ok (equal? '(320 240) (shape frame))
    "Check frame size of video frame")
(ok (is-a? frame <image>)
    "Check that video frame is an image object")
(ok (eqv? 5 (frame-rate video))
    "Get frame rate of video")
(ok (throws? (frame-rate audio))
    "Audio file does not have a frame rate")
(ok (not (cadr (list (read-video image) (read-video image))))
    "Image has only one frame")
(run-tests)
